/* jQuery Popups - v1.0.0 - 2014-06-02
 * https://github.com/harris-miller/Popups
 * Copyright (c) 2014 Harris Miller
 * Licensed MIT 
 */
+function(a,b,c){"use strict";function d(b){if(!b||!b[0])return{left:0,top:0};var c=b[0];return a.extend({},a.isFunction(c.getBoundingClientRect)?c.getBoundingClientRect():{width:c.offsetWidth,height:c.offsetHeight},b.offset())}function e(){var b=this.placement,c=o.exec(this.options.offset),d=this.$popupContainer[0].offsetWidth,e=this.$popupContainer[0].offsetHeight,f=0;return c||(c=o.exec(a.fn.popup.defaults.offset)),c&&c[1]&&(("right"===b||"left"===b)&&(f=e*(parseFloat(c[1])/100)),("top"===b||"bottom"===b)&&(f=d*(parseFloat(c[1])/100))),c&&c[2]&&(f+=parseFloat(c[2])),f}function f(){this.options.boundary||0===this.options.boundary||(this.options.boundary="0"),a.isNumeric(this.options.boundary)&&(this.options.boundary=this.options.boundary.toString());var b,c=this.options.boundary.split(" ");if(c.length<1||c>4)return{top:0,right:0,bottom:0,left:0};for(b=0;b<c.length;b++)c[b]=parseFloat(c[b])||0;switch(c.length){case 4:return{top:c[0],right:c[1],bottom:c[2],left:c[3]};case 3:return{top:c[0],right:c[1],bottom:c[2],left:c[1]};case 2:return{top:c[0],right:c[1],bottom:c[0],left:c[1]};case 1:return{top:c[0],right:c[0],bottom:c[0],left:c[0]};default:return{top:0,right:0,bottom:0,left:0}}}function g(a){var b,c,d=0,e=a.css("transition-duration").split(", "),f=a.css("transition-delay").split(", ");for(b=0;b<e.length;b++)c=parseFloat(e[b])+parseFloat(f[b]),d=c>d?c:d;return 1e3*d+30}function h(){var a=b.createElement("popup"),c={WebkitTransition:"webkitTransitionEnd",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var d in c)if(void 0!==a.style[d])return{end:c[d]};return!1}var i,j,k=a(c),l=a(b),m=a(b.body),n=0,o=/^(?:\+?(\-?\d+(?:\.\d+)?%))?(?:\+?(\-?\d+(?:\.\d+)?)(?:px)?)?$/,p=/top|bottom|right|left|middle|free/,q=/top|bottom|middle/,r=/right|left|middle/,s=/flip/,t=/fit/,u=function(c,d){var e=d;this.options=e,this.$el=c,this.isShowing=!1,this.guid="popup"+ ++n,!j&&(e.animate=!1),"string"!=typeof e.placement&&(e.placement="free"),e.placement=e.placement.toLowerCase(),!p.test(e.placement)&&(e.placement="free"),this.placement=e.placement,this.$anchor=a(e.anchor),this.boundary=f.call(this),this.$popupContainer=a('<div class="popup-container">').addClass(e.classes),e.showArrow&&this.$popupContainer.addClass("show-arrow"),this.$closeButton=e.showClose?a('<button class="popup-close" type="button"></button>').appendTo(this.$popupContainer):null,this.$arrow=e.showArrow?a('<div class="popup-arrow"><div class="inner-arrow"></div></div>').appendTo(this.$popupContainer):null,this.$closeButton&&this.$closeButton.on("click",a.proxy(this.hide,this)),e.container?a(e.container).append(c):a.contains(b.body,c.get(0))||m.append(c),c.after(this.$popupContainer),this.$popupContainer.append(c).hide(),e.animate&&this.$popupContainer.css("visibility","hidden"),this.$anchor&&this.$anchor.data("popup-ref",this.$el),k.on("resize."+this.guid,a.proxy(this.position,this)),c.trigger("create.popup"),e.autoShow&&this.show()};u.prototype.position=function(){if(this.isShowing){var a=this.placement,b=this.options,c=e.call(this),f=this.$popupContainer[0].offsetWidth,g=this.$popupContainer[0].offsetHeight,h=d(this.$anchor),j={top:null,left:null},m=this.boundary;if("free"!==a&&"middle"!==a&&s.test(b.collision)){var n=[],o=!1,p=function(){return h.left+h.width+f>k.width()-m.right?!1:"right"},u=function(){return h.left-f<m.left?!1:"left"},v=function(){return h.top+h.height+g>l.scrollTop()+k.height()-m.bottom?!1:"bottom"},w=function(){return h.top-g<l.scrollTop()+m.top?!1:"top"};switch(a){case"right":n=[p,u];break;case"left":n=[u,p];break;case"bottom":n=[v,w];break;case"top":n=[w,v]}for(i=0;i<n.length&&(o=n[i](),o===!1);i++);o===!1&&(o="middle"),a=o}switch(this.$popupContainer.removeClass("top bottom right left middle free").addClass(a),a){case"top":j={top:h.top-g-parseFloat(this.$popupContainer.css("margin-bottom")),left:h.left+h.width/2-c};break;case"bottom":j={top:h.top+h.height+parseFloat(this.$popupContainer.css("margin-top")),left:h.left+h.width/2-c};break;case"right":j={top:h.top+h.height/2-c,left:h.left+h.width+parseFloat(this.$popupContainer.css("margin-left"))};break;case"left":j={top:h.top+h.height/2-c,left:h.left-f-parseFloat(this.$popupContainer.css("margin-right"))};break;case"middle":j={top:l.scrollTop()+k.height()/2-g/2,left:k.width()/2-f/2};break;default:a="free"}if(t.test(b.collision)){var x;q.test(a)&&(j.left+f>k.width()-m.right&&(x=j.left+f-(k.width()-m.right),j.left-=x,c+=x),j.left<m.left&&(x=-j.left+m.left,j.left+=x,c-=x)),r.test(a)&&(j.top+g>l.scrollTop()+k.height()-m.bottom&&(x=j.top+g-(l.scrollTop()+k.height()-m.bottom),j.top-=x,c+=x),j.top<l.scrollTop()+m.top&&(x=l.scrollTop()-j.top+m.top,j.top+=x,c-=x))}if(this.$popupContainer.offset(j),b.showArrow){var y=this.$arrow,z={top:null,left:null},A=parseFloat(this.$popupContainer.css("border-top-width")),B=parseFloat(this.$popupContainer.css("border-left-width"));switch(y.css({left:"",right:"",top:"",bottom:""}),a){case"top":z={bottom:-y.outerHeight(),left:-y.outerWidth()/2+c-B};break;case"bottom":z={top:-y.outerHeight(),left:-y.outerWidth()/2+c-B};break;case"right":z={top:-y.outerHeight()/2+c-A,left:-y.outerWidth()};break;case"left":z={top:-y.outerHeight()/2+c-A,right:-y.outerWidth()}}y.css(z)}return this.$el.trigger("positioned.popup"),a}},u.prototype.show=function(){function a(){b.$popupContainer.addClass("showing"),b.$el.trigger("shown.popup")}var b=this;this.isShowing||(this.isShowing=!0,this.$el.trigger("show.popup"),this.$popupContainer.show(),this.position(),this.options.animate?this.$popupContainer.addClass("ani-start").css("visibility","visible").delay(30).queue(function(a){b.$popupContainer.addClass("ani-show"),a()}).delay(30).queue(function(d){b.$popupContainer.removeClass("ani-start"),c.setTimeout(function(){b.$popupContainer.removeClass("ani-show"),a()},g(b.$popupContainer)),d()}):a())},u.prototype.hide=function(){function a(){b.isShowing=!1,b.$popupContainer.hide(),b.$el.trigger("hidden.popup"),b.options.destroyOnHide&&b.destroy()}var b=this;this.jqXHR&&"pending"===this.jqXHR.state()&&(this.jqXHR.abort(),this.destroy()),this.isShowing&&(this.$el.trigger("hide.popup"),this.$popupContainer.removeClass("showing"),this.options.animate?this.$popupContainer.addClass("ani-hide").delay(30).queue(function(d){b.$popupContainer.addClass("ani-end"),c.setTimeout(function(){b.$popupContainer.removeClass("ani-hide ani-end").css("visibility","hidden"),a()},g(b.$popupContainer)),d()}):a())},u.prototype.toggle=function(){this.isShowing?this.hide():this.show()},u.prototype.destroy=function(){this.$anchor&&this.$anchor.removeData("popup-ref"),k.off("resize."+this.guid),this.$el.off(".popup"),this.$el.trigger("destroy.popup"),this.$popupContainer.remove()},u.prototype.setContent=function(a){this.$el.empty().append(a),this.position()};var v=a.fn.popup;a.fn.popup=function(b,c){var d=null;return this.each(function(){var e=a(this),f=e.data("popup");if(this.readyState&&this.promise){b.jqXHR=this;var g=a('<div class="popup-inner">').popup(b);return g.popup("$popup").addClass("loading"),this.always(function(){g.popup("$popup").removeClass("loading")}),d=g,!1}if(f)if("string"==typeof b){if(f[b]&&(d=a.isFunction(f[b])?f[b](c):f[b]),d)return!1}else!b||a.isPlainObject(b)?f.toggle():a.error("fn.popup says: Method or Property you are trying to access does not exist");else b=a.extend({},a.fn.popup.defaults,a.isPlainObject(b)&&b,e.data()),e.data("popup",f=new u(e,b))}),d||this},a.popup=function(b,c){var d=a(b).first();return 0===d.length?(a.error("fn.popup says: selector returned zero results"),d):d.popup(c)},a.fn.popup.Constructor=u,a.fn.popup.defaults={animate:!1,anchor:null,autoShow:!0,boundary:10,classes:null,collision:"flip",container:null,destroyOnHide:!1,offset:"50%",placement:"right",showArrow:!1,showClose:!1},a.fn.popup.noConflict=function(){return a.fn.popup=v,this},a(function(){j=h()})}(jQuery,document,window);